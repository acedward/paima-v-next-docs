<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-home/components/sync-service" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Sync Protocols &amp; Chain Config | Paima Engine</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.paimastudios.com/paima-v-next-docs/img/paima-banner.png"><meta data-rh="true" name="twitter:image" content="https://docs.paimastudios.com/paima-v-next-docs/img/paima-banner.png"><meta data-rh="true" property="og:url" content="https://docs.paimastudios.com/paima-v-next-docs/home/components/sync-service"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Sync Protocols &amp; Chain Config | Paima Engine"><meta data-rh="true" name="description" content="The Sync Service is the core data-ingestion layer of a Paima Engine node. It acts as the engine&#x27;s monitor connecting to different blockchains, checking for specific on-chain events, and feeding them in a deterministic, ordered stream to the State Machine."><meta data-rh="true" property="og:description" content="The Sync Service is the core data-ingestion layer of a Paima Engine node. It acts as the engine&#x27;s monitor connecting to different blockchains, checking for specific on-chain events, and feeding them in a deterministic, ordered stream to the State Machine."><link data-rh="true" rel="icon" href="/paima-v-next-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.paimastudios.com/paima-v-next-docs/home/components/sync-service"><link data-rh="true" rel="alternate" href="https://docs.paimastudios.com/paima-v-next-docs/home/components/sync-service" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.paimastudios.com/paima-v-next-docs/ja/home/components/sync-service" hreflang="ja"><link data-rh="true" rel="alternate" href="https://docs.paimastudios.com/paima-v-next-docs/home/components/sync-service" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><link rel="stylesheet" href="/paima-v-next-docs/assets/css/styles.c5930e85.css">
<script src="/paima-v-next-docs/assets/js/runtime~main.7e41bb7b.js" defer="defer"></script>
<script src="/paima-v-next-docs/assets/js/main.376458a5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/paima-v-next-docs/img/favicon.ico"><div role="region" aria-label="Skip to main content"><a class="skipToContent_LRwd" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_llC7" style="background-color:#2B3831;color:#ffffff" role="banner"><div class="content_Pagn announcementBarContent_QHqT">
      <div class="custom-banner">
        <p><strong>You are looking at Paima Engine v2 docs</strong></p>
        <p>Paima Engine v2 is still under constructionðŸš§</p>
      </div>
    </div></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/paima-v-next-docs/"><div class="navbar__logo"><img src="/paima-v-next-docs/img/favicon.ico" alt="Paima logo" class="themedComponent_m_92 themedComponent--light_mRW5"><img src="/paima-v-next-docs/img/favicon.ico" alt="Paima logo" class="themedComponent_m_92 themedComponent--dark_iQ27"></div><b class="navbar__title text--truncate">Paima</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_J6rI"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/paima-v-next-docs/home/components/sync-service" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/paima-v-next-docs/ja/home/components/sync-service" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">Japanese</a></li></ul></div><div class="navbarSearchContainer_E3Re"><div class="navbar__search searchBarContainer_sERs" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_s8y1 searchBarLoadingRing_W2S3"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_Gcnp"><div class="docsWrapper_xhHm"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_P6dF" type="button"></button><div class="docRoot_QZFe"><aside class="theme-doc-sidebar-container docSidebarContainer_z8Xi"><div class="sidebarViewport_LtND"><div class="sidebar_eBd7"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_sQgX menuWithAnnouncementBar_IFIy"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/paima-v-next-docs/">Intro</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/what-is-paima-engine">What is Paima Engine?</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/paima-v-next-docs/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/paima-v-next-docs/home/components/">Components</a><button aria-label="Collapse sidebar category &#x27;Components&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/paima-v-next-docs/home/components/sync-service">Sync Protocols &amp; Chain Config</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/state-machine">State Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/api">API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/paima-l2-contract">Paima L2 Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/contracts">Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/processes">Process Orchestrator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/explorer">Paima Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/batcher">Batcher</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/database">Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/logs">Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/grammar">Grammar</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/wallets">Wallets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/randomness">Randomness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/achievements">Achievements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/frontend">Frontend (dApp)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paima-v-next-docs/home/components/accounts">Accounts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/paima-v-next-docs/home/chains/">Chains</a><button aria-label="Expand sidebar category &#x27;Chains&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/paima-v-next-docs/home/deployment/deploy-game">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/paima-v-next-docs/home/paima-standards/">Paima Standards (PRCs)</a><button aria-label="Expand sidebar category &#x27;Paima Standards (PRCs)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/paima-v-next-docs/home/paima-engine/">Architecture</a><button aria-label="Expand sidebar category &#x27;Architecture&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/paima-v-next-docs/home/example-tarochi/">Game Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/PaimaStudios/paima-game-templates" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_TdTm">Paima Game Templates<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Y7wO"><use href="#theme-svg-external-link"></use></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/PaimaStudios/paima-engine/" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_TdTm">Paima Engine Code<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Y7wO"><use href="#theme-svg-external-link"></use></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://paimastudios.com" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_TdTm">Paima Studios Website<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Y7wO"><use href="#theme-svg-external-link"></use></svg></a></li></ul></nav></div></div></aside><main class="docMainContainer_PnPB"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Haw5"><div class="docItemContainer_OM9T"><article><div class="tocCollapsible_o4j2 theme-doc-toc-mobile tocMobile_PSvY"><button type="button" class="clean-btn tocCollapsibleButton_GQbL">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Sync Protocols &amp; Chain Config</h1></header>
<p>The Sync Service is the core data-ingestion layer of a <code>Paima Engine</code> node. It acts as the engine&#x27;s monitor connecting to different blockchains, checking for specific on-chain events, and feeding them in a deterministic, ordered stream to the <a href="/paima-v-next-docs/home/components/state-machine">State Machine</a>.</p>
<p>This entire service is configured using the <code>ConfigBuilder</code>, a powerful tool that allows you to define exactly which chains to connect to and what data to capture.</p>
<h2 class="anchor anchorWithStickyNavbar_qIhk" id="the-configbuilder">The <code>ConfigBuilder</code><a href="#the-configbuilder" class="hash-link" aria-label="Direct link to the-configbuilder" title="Direct link to the-configbuilder">â€‹</a></h2>
<p>The configuration is built using a fluent, step-by-step interface called the <code>ConfigBuilder</code>. This pattern guides you through the process of defining the components of your data pipeline, ensuring a valid and coherent setup.</p>
<p>The main steps are:</p>
<ol>
<li><strong>Define Networks</strong>: Specify which blockchains you want to connect to.</li>
<li><strong>Define Deployments (Optional)</strong>: Create aliases for your deployed contract addresses for cleaner configuration.</li>
<li><strong>Define Sync Protocols</strong>: Specify <em>how</em> the engine should sync data from each network.</li>
<li><strong>Define Primitives</strong>: Specify <em>what specific events</em> the engine should listen for on those networks.</li>
</ol>
<p>Let&#x27;s break down each step using a real-world multi-chain example.</p>
<div class="language-ts codeBlockContainer_Epcf theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_zcFB"><pre tabindex="0" class="prism-code language-ts codeBlock_JaaR thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_O7QW"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// The entry point is always creating a new ConfigBuilder instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> localhostConfig </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ConfigBuilder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ... chain the build steps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">build</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_qIhk" id="step-1-defining-networks-buildnetworks">Step 1: Defining Networks (<code>buildNetworks</code>)<a href="#step-1-defining-networks-buildnetworks" class="hash-link" aria-label="Direct link to step-1-defining-networks-buildnetworks" title="Direct link to step-1-defining-networks-buildnetworks">â€‹</a></h3>
<p>This is where you list all the blockchains your application will interact with. Each network is given a unique name for reference in later steps. Paima Engine supports various network types.</p>
<p>In this example, we define an EVM network (<code>evmParallel_fast</code>), a private Midnight network, and a special <code>NTP</code> network that acts as a deterministic clock.</p>
<div class="language-ts codeBlockContainer_Epcf theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_zcFB"><pre tabindex="0" class="prism-code language-ts codeBlock_JaaR thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_O7QW"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">buildNetworks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">builder </span><span class="token operator">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    builder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// A special network that isn&#x27;t a blockchain, but a deterministic clock.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// It produces a new &quot;block&quot; every `blockTimeMS`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addNetwork</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ntp&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        type</span><span class="token operator">:</span><span class="token plain"> ConfigNetworkType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">NTP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        startTime</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getTime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        blockTimeMS</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// A new block every 1 second</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// An EVM network using viem&#x27;s chain definitions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addViemNetwork</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token operator">...</span><span class="token plain">hardhat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Base configuration from viem</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;evmParallel_fast&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// A Zero-Knowledge network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addNetwork</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;midnight&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        type</span><span class="token operator">:</span><span class="token plain"> ConfigNetworkType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">MIDNIGHT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// ... midnight specific configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_qIhk" id="step-2-defining-deployments-builddeployments">Step 2: Defining Deployments (<code>buildDeployments</code>)<a href="#step-2-defining-deployments-builddeployments" class="hash-link" aria-label="Direct link to step-2-defining-deployments-builddeployments" title="Direct link to step-2-defining-deployments-builddeployments">â€‹</a></h3>
<p>This optional but highly recommended step allows you to register the addresses of your deployed smart contracts. This keeps your configuration clean, as you can refer to contracts by name instead of repeatedly pasting addresses.</p>
<div class="language-ts codeBlockContainer_Epcf theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_zcFB"><pre tabindex="0" class="prism-code language-ts codeBlock_JaaR thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_O7QW"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">buildDeployments</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    builder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addDeployment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">evmParallel_fast</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Target the network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">_network</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PaimaErc20DevModule#PaimaErc20Dev&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// A unique name for this contract</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          address</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x...&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// The contract&#x27;s address. Generated and available in the @example/contract-evm package</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_qIhk" id="step-3-defining-sync-protocols-buildsyncprotocols">Step 3: Defining Sync Protocols (<code>buildSyncProtocols</code>)<a href="#step-3-defining-sync-protocols-buildsyncprotocols" class="hash-link" aria-label="Direct link to step-3-defining-sync-protocols-buildsyncprotocols" title="Direct link to step-3-defining-sync-protocols-buildsyncprotocols">â€‹</a></h3>
<p>This is the most critical step. Here, you define <em>how</em> Paima Engine will fetch data from the networks you defined. There are two types of protocols: <strong>Main</strong> and <strong>Parallel</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_qIhk" id="available-sync-protocols">Available Sync Protocols<a href="#available-sync-protocols" class="hash-link" aria-label="Direct link to Available Sync Protocols" title="Direct link to Available Sync Protocols">â€‹</a></h3>
<p>When you define a sync protocol using <code>.addMain()</code> or <code>.addParallel()</code>, you must specify its <code>type</code>. This tells the Paima Engine what kind of data source it&#x27;s connecting to and how to interpret the data.</p>
<h4 class="anchor anchorWithStickyNavbar_qIhk" id="the-main-protocol-a-deterministic-clock">The Main Protocol: A Deterministic Clock<a href="#the-main-protocol-a-deterministic-clock" class="hash-link" aria-label="Direct link to The Main Protocol: A Deterministic Clock" title="Direct link to The Main Protocol: A Deterministic Clock">â€‹</a></h4>
<p>In Paima Engine, your application&#x27;s &quot;heartbeat&quot; is driven by a single <strong>Main</strong> protocol. This protocol&#x27;s block progression defines the official timeline for your entire state machine. All events from all other connected chains are deterministically mapped onto this timeline.</p>
<p>For maximum consistency and to decouple your application&#x27;s tick-rate from the variable block times of real-world blockchains, the main protocol is always a Network Time Protocol (NTP) clock.</p>
<ul>
<li><strong><code>ConfigSyncProtocolType.NTP_MAIN</code></strong>: This protocol is not a blockchain. It is a high-precision, deterministic clock that produces a new &quot;block&quot; at a fixed interval (e.g., every 1000 milliseconds). This creates a perfectly stable tick-rate for your game or dApp, ensuring that time-based logic is predictable and consistent across all nodes.</li>
</ul>
<div class="language-ts codeBlockContainer_Epcf theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_zcFB"><pre tabindex="0" class="prism-code language-ts codeBlock_JaaR thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_O7QW"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addMain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ntp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Target the NTP network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">network</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> deployments</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;mainNtp&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        type</span><span class="token operator">:</span><span class="token plain"> ConfigSyncProtocolType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">NTP_MAIN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// The only valid type for `addMain`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_qIhk" id="parallel-protocols-real-world-data-sources">Parallel Protocols: Real-World Data Sources<a href="#parallel-protocols-real-world-data-sources" class="hash-link" aria-label="Direct link to Parallel Protocols: Real-World Data Sources" title="Direct link to Parallel Protocols: Real-World Data Sources">â€‹</a></h4>
<p><strong>Parallel</strong> protocols run alongside the main clock and are responsible for fetching data from actual blockchains. You can add as many parallel protocols as you need to create a rich, multi-chain application.</p>
<table><thead><tr><th style="text-align:left">Protocol Type</th><th style="text-align:left">Target Blockchain</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left"><strong><code>EVM_RPC_PARALLEL</code></strong></td><td style="text-align:left">EVM</td><td style="text-align:left">The most common type. Connects to any EVM-compatible chain (like Ethereum, Arbitrum, Polygon) via a standard JSON-RPC endpoint to fetch block data and logs.</td></tr><tr><td style="text-align:left"><strong><code>CARDANO_CARP_PARALLEL</code></strong></td><td style="text-align:left">Cardano</td><td style="text-align:left">Connects to the Cardano network using a <a href="https://dcspark.github.io/carp/docs/intro" target="_blank" rel="noopener noreferrer">Carp</a> indexer.</td></tr><tr><td style="text-align:left"><strong><code>CARDANO_UTXORPC_PARALLEL</code></strong></td><td style="text-align:left">Cardano</td><td style="text-align:left">An alternative way to connect to Cardano using a <a href="https://www.utxorpc.org/" target="_blank" rel="noopener noreferrer">UTXO-RPC</a> compatible service like Dolos.</td></tr><tr><td style="text-align:left"><strong><code>MINA_PARALLEL</code></strong></td><td style="text-align:left">Mina</td><td style="text-align:left">Connects to the Mina Protocol to sync data from zkApps.</td></tr><tr><td style="text-align:left"><strong><code>AVAIL_PARALLEL</code></strong></td><td style="text-align:left">Avail</td><td style="text-align:left">Connects to the Avail Data Availability (DA) layer to fetch application-specific data blobs.</td></tr><tr><td style="text-align:left"><strong><code>MIDNIGHT_PARALLEL</code></strong></td><td style="text-align:left">Midnight</td><td style="text-align:left">Connects to the Midnight network to sync state from its ZK-powered smart contracts.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_qIhk" id="configuration-example">Configuration Example<a href="#configuration-example" class="hash-link" aria-label="Direct link to Configuration Example" title="Direct link to Configuration Example">â€‹</a></h3>
<p>Here is how you would combine these protocols in a <code>ConfigBuilder</code> to create a multi-chain application that has a 1-second tick rate and pulls in data from an EVM chain and a Midnight network simultaneously.</p>
<div class="language-ts codeBlockContainer_Epcf theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_zcFB"><pre tabindex="0" class="prism-code language-ts codeBlock_JaaR thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_O7QW"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">buildSyncProtocols</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    builder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// 1. Define the main clock for the entire application.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addMain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ntp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">network</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> deployments</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;mainNtp&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          type</span><span class="token operator">:</span><span class="token plain"> ConfigSyncProtocolType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">NTP_MAIN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          startBlockHeight</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          pollingInterval</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// 2. Add a parallel protocol to sync data from an EVM chain.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addParallel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">evmParallel_fast</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">network</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> deployments</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;parallelEvmRPC_fast&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          type</span><span class="token operator">:</span><span class="token plain"> ConfigSyncProtocolType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">EVM_RPC_PARALLEL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          chainUri</span><span class="token operator">:</span><span class="token plain"> network</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rpcUrls</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">default</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          startBlockHeight</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          pollingInterval</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">500</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// 3. Add another parallel protocol to sync data from Midnight.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addParallel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> networks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">midnight</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">network</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> deployments</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;parallelMidnight&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          type</span><span class="token operator">:</span><span class="token plain"> ConfigSyncProtocolType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">MIDNIGHT_PARALLEL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          startBlockHeight</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          pollingInterval</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          indexer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://127.0.0.1:8088/api/v1/graphql&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_qIhk" id="step-4-defining-primitives-buildprimitives">Step 4: Defining Primitives (<code>buildPrimitives</code>)<a href="#step-4-defining-primitives-buildprimitives" class="hash-link" aria-label="Direct link to step-4-defining-primitives-buildprimitives" title="Direct link to step-4-defining-primitives-buildprimitives">â€‹</a></h3>
<p>Primitives are the specific event listeners. This is where you tell the engine, &quot;On this protocol, watch this contract for this specific event.&quot;</p>
<p>Each primitive is linked to a <strong><code>scheduledPrefix</code></strong>. This prefix is the crucial link between the Sync Service and the State Machine. When a primitive detects an event, it creates an input with this prefix, which in turn triggers the corresponding State Transition Function (STF).</p>
<p>In this example, we are tracking the <code>Transfer</code> event from an ERC20 contract.</p>
<div class="language-ts codeBlockContainer_Epcf theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_zcFB"><pre tabindex="0" class="prism-code language-ts codeBlock_JaaR thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_O7QW"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">buildPrimitives</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">builder </span><span class="token operator">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    builder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">addPrimitive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// 1. Select the protocol to listen on.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">syncProtocols</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> syncProtocols</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">parallelEvmRPC_fast</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// 2. Define the primitive&#x27;s properties.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">network</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> deployments</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> syncProtocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;My_ERC20_Token&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          type</span><span class="token operator">:</span><span class="token plain"> ConfigPrimitiveType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">EvmRpcERC20</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// This primitive automatically tracks ERC20 balances.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          startBlockHeight</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          contractAddress</span><span class="token operator">:</span><span class="token plain"> deployments</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PaimaErc20DevModule#PaimaErc20Dev&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          abi</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">getEvmEvent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">erc20dev</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">abi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Transfer(address,address,uint256)&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)">// 3. The link to the State Machine.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)">// This will trigger the STF registered with the name &quot;transfer&quot;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          scheduledPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;transfer&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>By combining these steps, you create a powerful, multi-chain data pipeline that transforms raw on-chain events into a clean, ordered set of inputs for your application logic.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/PaimaStudios/paima-engine-docs/tree/main/docs/home/100-components/101-sync-service.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_uRRq" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_xDOh"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/paima-v-next-docs/home/components/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Paima Engine Components</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/paima-v-next-docs/home/components/state-machine"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">State Machine</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Fe6u thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-configbuilder" class="table-of-contents__link toc-highlight">The <code>ConfigBuilder</code></a><ul><li><a href="#step-1-defining-networks-buildnetworks" class="table-of-contents__link toc-highlight">Step 1: Defining Networks (<code>buildNetworks</code>)</a></li><li><a href="#step-2-defining-deployments-builddeployments" class="table-of-contents__link toc-highlight">Step 2: Defining Deployments (<code>buildDeployments</code>)</a></li><li><a href="#step-3-defining-sync-protocols-buildsyncprotocols" class="table-of-contents__link toc-highlight">Step 3: Defining Sync Protocols (<code>buildSyncProtocols</code>)</a></li><li><a href="#available-sync-protocols" class="table-of-contents__link toc-highlight">Available Sync Protocols</a></li><li><a href="#configuration-example" class="table-of-contents__link toc-highlight">Configuration Example</a></li><li><a href="#step-4-defining-primitives-buildprimitives" class="table-of-contents__link toc-highlight">Step 4: Defining Primitives (<code>buildPrimitives</code>)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Paima Studios. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>